README â€” find_pair (ES)
Â¿QuÃ© hace?

Resuelve una pareja de tiempos de retenciÃ³n 
â€˜
ğ‘¡
3
â€˜
,
â€˜
ğ‘¡
4
â€˜
â€˜t3â€˜,â€˜t4â€˜ a partir de dos conjuntos de candidatos (grupo/canal â€œ3â€ y â€œ4â€). Combina proximidad en RT con prioridad por intensidad y, si no encuentra pareja dentro de una ventana asimÃ©trica, genera una pareja sintÃ©tica desplazada Â±0,5 unidades.

Entradas

rts3 â€” vector de RTs candidatos del grupo 3.

top1_rt3 â€” RT del mejor candidato del grupo 3.

inten_sum3 â€” intensidades alineadas con rts3.

top1_inten_sum3 â€” intensidad del mejor candidato del grupo 3.

rts4 â€” vector de RTs candidatos del grupo 4.

top1_rt4 â€” RT del mejor candidato del grupo 4.

inten_sum4 â€” intensidades alineadas con rts4.

top1_inten_sum4 â€” intensidad del mejor candidato del grupo 4.

Requisito: las longitudes de rts? e inten_sum? deben coincidir y estar alineadas Ã­ndice a Ã­ndice.

Salidas

t3, t4 â€” RTs emparejados. Si no se encuentra pareja en la ventana del otro grupo, se usa un desplazamiento fijo:

Anclando en 3: t4 = top1_rt3 - 0.5

Anclando en 4: t3 = top1_rt4 + 0.5
Si ambas listas estÃ¡n vacÃ­as â†’ t3 = 0, t4 = 0.

Reglas de emparejamiento

Ambos no vacÃ­os:

Si top1_rt4 cae en [top1_rt3 âˆ’ 2, top1_rt3 + 0.5] â†’ pareja directa (t3 = top1_rt3, t4 = top1_rt4).

Si no:

Si top1_inten_sum3 > top1_inten_sum4 â†’ ancla en top1_rt3.
Busca en rts4 dentro de [top1_rt3 âˆ’ 2, top1_rt3 + 0.5] y elige el mÃ¡ximo por inten_sum4.
Si no hay candidatos â†’ t4 = top1_rt3 âˆ’ 0.5.

En caso contrario â†’ ancla en top1_rt4.
Busca en rts3 dentro de [top1_rt4 âˆ’ 0.5, top1_rt4 + 2] y elige el mÃ¡ximo por inten_sum3.
Si no hay candidatos â†’ t3 = top1_rt4 + 0.5.
En ambos casos, el ancla se copia al otro (t3 = top1_rt3 o t4 = top1_rt4).

Solo uno no vacÃ­o:

Solo grupo 3 â†’ (t3, t4) = (top1_rt3, top1_rt3 âˆ’ 0.5).

Solo grupo 4 â†’ (t3, t4) = (top1_rt4 + 0.5, top1_rt4).

Ambos vacÃ­os â†’ (t3, t4) = (0, 0).

Ventanas asimÃ©tricas

Al buscar en 4 desde 3: [top1_rt3 âˆ’ 2, top1_rt3 + 0.5].

Al buscar en 3 desde 4: [top1_rt4 âˆ’ 0.5, top1_rt4 + 2].

[Inferencia] La asimetrÃ­a modela un desplazamiento sistemÃ¡tico esperado entre canales (p. ej., etiquetado isotÃ³pico o diferencias cromatogrÃ¡ficas), permitiendo mÃ¡s holgura hacia â€œun ladoâ€ segÃºn el ancla.

Detalles prÃ¡cticos

ElecciÃ³n por intensidad: se usa el mÃ¡ximo dentro de la ventana. Si hay empates, max devuelve el primero.

Unidades: la funciÃ³n no las impone; generalmente minutos en LCâ€“MS.

Robustez: si las listas estÃ¡n mal alineadas o las ventanas no capturan el desplazamiento real, aparecerÃ¡n mÃ¡s parejas sintÃ©ticas (Â±0,5). Ajusta esas ventanas en funciones de nivel superior si fuera necesario (no aquÃ­).